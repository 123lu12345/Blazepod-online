<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <title>BlazePod Dashboard</title>
    <style>
        body {
            background-color: #111;
            color: white;
            font-family: sans-serif;
            text-align: center;
            padding: 20px;
        }
        h1 {
            font-size: 36px;
        }
        .pods, .controls, .settings {
            margin: 20px 0;
            font-size: 20px;
        }
        button {
            padding: 10px 20px;
            font-size: 18px;
            border: none;
            border-radius: 10px;
            margin: 5px;
        }
        .start { background-color: #007bff; color: white; }
        .stop { background-color: #dc3545; color: white; }
        .restart { background-color: #28a745; color: white; }
        input, select {
            font-size: 18px;
            padding: 5px;
            border-radius: 5px;
            margin-left: 10px;
        }
        .qr {
            margin: 10px;
        }
    </style>
</head>
<body>
    <h1>BlazePod Dashboard</h1>
    <div class="pods">
        <button id="pod1">Pod 1</button>
        <button id="pod2">Pod 2</button>
        <button id="pod3">Pod 3</button>
        <button id="pod4">Pod 4</button>
    </div>
    <div class="settings">
        <label>Spielzeit (min): <input type="number" id="duration" value="1"></label>
        <label>Blink-Intervall (sek): <input type="number" id="interval" value="1"></label>
        <label>Pausenzeit (sek): <input type="number" id="pause" value="1"></label><br><br>
        <label>Modus: 
            <select id="mode">
                <option>Classic</option>
                <option>Touch to Switch</option>
                <option>Memory</option>
            </select>
        </label>
        <label id="memoryLabel" style="display:none;">Memory-Länge:
            <input type="number" id="memoryLength" value="5">
        </label><br><br>
        <label>Benötigte Pods: 
            <select id="pods">
                <option>1</option><option>2</option><option>3</option><option selected>4</option>
            </select>
        </label>
        <label><input type="checkbox" id="multicolor"> Mehrfarbenmodus aktivieren</label>
    </div>
    <div class="controls">
        <button class="start" onclick="startGame()">Start</button>
        <button class="stop" onclick="stopGame()">Stopp</button>
        <button class="restart" onclick="location.reload()">Neustart</button>
        <p id="status">Verbleibende Zeit: --</p>
    </div>
    <h3>QR-Codes für Pods</h3>
    <div id="qr" class="qr"></div>
    <script>
        const modeSelect = document.getElementById('mode');
        modeSelect.onchange = () => {
            document.getElementById('memoryLabel').style.display = modeSelect.value === 'Memory' ? 'inline' : 'none';
        };

        function updateQR() {
            const count = parseInt(document.getElementById('pods').value);
            let qr = "";
            for (let i = 1; i <= count; i++) {
                qr += `<img src="https://api.qrserver.com/v1/create-qr-code/?data=/pod/${i}&size=100x100"> `;
            }
            document.getElementById('qr').innerHTML = qr;
        }

        document.getElementById('pods').onchange = updateQR;
        updateQR();

        function startGame() {
            fetch('/update_settings', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    duration: document.getElementById('duration').value,
                    interval: document.getElementById('interval').value,
                    pause: document.getElementById('pause').value,
                    mode: document.getElementById('mode').value,
                    multicolor: document.getElementById('multicolor').checked,
                    memory_length: document.getElementById('memoryLength').value,
                    pods: document.getElementById('pods').value
                })
            }).then(() => fetch('/start', { method: 'POST' }));
        }

        function stopGame() {
            fetch('/stop', { method: 'POST' });
        }

        setInterval(() => {
            fetch('/status').then(res => res.json()).then(data => {
                document.getElementById('status').textContent = 
                    "Verbleibende Zeit: " + Math.floor(data.remaining_time / 60) + ":" + ("0" + (data.remaining_time % 60)).slice(-2);
            });
        }, 1000);
    </script>
</body>
</html>
